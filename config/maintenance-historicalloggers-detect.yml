sql:
- name: Logging Added Changes in coagis.coa_historical_logger_bc_property;
  text: insert into coagis.coa_historical_logger_bc_property select  ST_AsText(shape)::text as shapetext, pinnum::text, pin::text, pinext::text, substr(trim("owner"),0,8)::text, nmptype::text, taxyear::text, housenumber::text, condounit::text, condobuilding::text, deedbook::text, deedpage::text, platbook::text, platpage::text, numbersuffix::text, direction::text, streetname::text, streettype::text, city::text, careof::text, address::text, priced::text, totalmarketvalue::float, appraisedvalue::float, landvalue::float, buildingvalue::float, improvementvalue::float, accountnumber::text, deeddate::text, improved::text, exempt::text, "class"::text, acreage::float as tax_acreage, now()::date as added_date, ''::text as change_flag, 'TO'::text as source, taxvalue::float, sublot::text, subblock::text, subsect::text, updatedate::text, cityname::text, state::text, landuse::text from coagis.bc_property except select    ST_AsText(shape)::text as shapetext, pinnum::text, pin::text, pinext::text, substr(trim("owner"),0,8)::text, nmptype::text, taxyear::text, housenumber::text, condounit::text, condobuilding::text, deedbook::text, deedpage::text, platbook::text, platpage::text, numbersuffix::text, direction::text, streetname::text, streettype::text, city::text, careof::text, address::text, priced::text, totalmarketvalue::float, appraisedvalue::float, landvalue::float, buildingvalue::float, improvementvalue::float, accountnumber::text, deeddate::text, improved::text, exempt::text, "class"::text, acreage::float as tax_acreage, now()::date as added_date, ''::text as change_flag, 'TO'::text as source, taxvalue::float, sublot::text, subblock::text, subsect::text, updatedate::text, cityname::text, state::text, landuse::text from coagis.bc_property_yesterday;
  values:
- name: Logging deleted Changes in coagis.coa_historical_logger_bc_property;
  text: insert into coagis.coa_historical_logger_bc_property select ST_AsText(shape)::text as shapetext, pinnum::text, pin::text, pinext::text, substr(trim("owner"),0,8)::text, nmptype::text, taxyear::text, housenumber::text, condounit::text, condobuilding::text, deedbook::text, deedpage::text, platbook::text, platpage::text, numbersuffix::text, direction::text, streetname::text, streettype::text, city::text, careof::text, address::text, priced::text, totalmarketvalue::float, appraisedvalue::float, landvalue::float, buildingvalue::float, improvementvalue::float, accountnumber::text, deeddate::text, improved::text, exempt::text, "class"::text, acreage::float as tax_acreage, now()::date as added_date, ''::text as change_flag, 'FROM'::text as source, taxvalue::float, sublot::text, subblock::text, subsect::text, updatedate::text, cityname::text, state::text, landuse::text from coagis.bc_property_yesterday  except select  ST_AsText(shape)::text as shapetext, pinnum::text, pin::text, pinext::text, substr(trim("owner"),0,8)::text, nmptype::text, taxyear::text, housenumber::text, condounit::text, condobuilding::text, deedbook::text, deedpage::text, platbook::text, platpage::text, numbersuffix::text, direction::text, streetname::text, streettype::text, city::text, careof::text, address::text, priced::text, totalmarketvalue::float, appraisedvalue::float, landvalue::float, buildingvalue::float, improvementvalue::float, accountnumber::text, deeddate::text, improved::text, exempt::text, "class"::text, acreage::float as tax_acreage, now()::date as added_date, ''::text as change_flag, 'FROM'::text as source, taxvalue::float, sublot::text, subblock::text, subsect::text, updatedate::text, cityname::text, state::text, landuse::text from coagis.bc_property;
  values:
- name: Mark added  Changes in coagis.coa_historical_logger_bc_property;
  text: UPDATE coagis.coa_historical_logger_bc_property as ch  SET  change_flag = 'ADDED' WHERE  ch.pinnum = (SELECT c.pinnum FROM coagis.bc_property  AS c LEFT JOIN coagis.bc_property_yesterday AS y ON c.pinnum = y.pinnum WHERE y.pinnum IS NULL and c.pinnum = ch.pinnum) AND ch.added_date = now()::date;
  values:
- name: Mark Deleted Changes in coagis.coa_historical_logger_bc_property;
  text: UPDATE coagis.coa_historical_logger_bc_property as ch  SET  change_flag = 'DELETED' WHERE ch.pinnum = (SELECT y.pinnum FROM coagis.bc_property as c RIGHT JOIN coagis.bc_property_yesterday AS y ON c.pinnum = y.pinnum WHERE c.pinnum IS NULL and y.pinnum = ch.pinnum) AND ch.added_date = now()::date; 
  values:
- name: Mark Changed  Changes in coagis.coa_historical_logger_bc_property;
  text: UPDATE coagis.coa_historical_logger_bc_property as ch  SET change_flag = 'CHANGED' WHERE change_flag = '' AND ch.added_date = now()::date;
  values:
- name: Logging Added Changes in coagis.coa_historical_logger_bc_address;
  text: insert into coagis.coa_historical_logger_bc_address select ST_AsText(shape)::text as shapetext, x::double precision, y::double precision, address::text, "number"::integer, apt::text, street_type::text, street_name::text, postdirection::text, civicaddress_id::double precision, location_type::integer, change_date::timestamp without time zone, city::text, zipcode::integer, now()::date as added_date, ''::text as change_flag, 'TO'::text as source from coagis.bc_address except select    ST_AsText(shape)::text as shapetext, x::double precision, y::double precision, address::text, "number"::integer, apt::text, street_type::text, street_name::text, postdirection::text, civicaddress_id::double precision, location_type::integer, change_date::timestamp without time zone, city::text, zipcode::integer, now()::date as added_date, ''::text as change_flag, 'TO'::text as source from coagis.bc_address_yesterday;
  values:
- name: Logging deleted Changes in coagis.coa_historical_logger_bc_address;
  text: insert into coagis.coa_historical_logger_bc_address select   ST_AsText(shape)::text as shapetext, x::double precision, y::double precision, address::text, "number"::integer, apt::text, street_type::text, street_name::text, postdirection::text, civicaddress_id::double precision, location_type::integer, change_date::timestamp without time zone, city::text, zipcode::integer, now()::date as added_date, ''::text as change_flag, 'FROM'::text as source from coagis.bc_address_yesterday except select  ST_AsText(shape)::text as shapetext, x::double precision, y::double precision, address::text, "number"::integer, apt::text, street_type::text, street_name::text, postdirection::text, civicaddress_id::double precision, location_type::integer, change_date::timestamp without time zone, city::text, zipcode::integer, now()::date as added_date, ''::text as change_flag, 'FROM'::text as source from coagis.bc_address;
  values:
- name: Mark added  Changes in coagis.coa_historical_logger_bc_address;
  text: UPDATE coagis.coa_historical_logger_bc_address as ch  SET  change_flag = 'ADDED' WHERE ch.civicaddress_id = (SELECT distinct c.civicaddress_id FROM coagis.bc_address  AS c LEFT JOIN coagis.bc_address_yesterday AS y ON c.civicaddress_id = y.civicaddress_id WHERE y.civicaddress_id IS NULL and c.civicaddress_id = ch.civicaddress_id)  AND ch.added_date = now()::date;
  values:
- name: Mark Deleted Changes in coagis.coa_historical_logger_bc_address;
  text: UPDATE coagis.coa_historical_logger_bc_address as ch  SET  change_flag = 'DELETED' WHERE ch.civicaddress_id = (SELECT distinct y.civicaddress_id FROM coagis.bc_address as c RIGHT JOIN coagis.bc_address_yesterday AS y ON c.civicaddress_id = y.civicaddress_id WHERE c.civicaddress_id IS NULL and y.civicaddress_id = ch.civicaddress_id) AND ch.added_date = now()::date;
  values:
- name: Mark Changed  Changes in coagis.coa_historical_logger_bc_address;
  text: UPDATE coagis.coa_historical_logger_bc_address as ch  SET change_flag = 'CHANGED' WHERE change_flag = '' AND ch.added_date = now()::date;
  values:
- name: Logging Added Changes in coagis.coa_historical_logger_bc_street;
  text: insert into coagis.coa_historical_logger_bc_street select ST_AsText(shape)::text as shapetext, centerline_id::double precision, road_class::integer, street_prefix::text, street_name::text, street_type::text, street_postdirection::text, street_dupe::text, full_street_name::text, speed_limit::integer, lane_count::integer, left_from_address::integer, left_to_address::integer, right_from_address::integer, right_to_address::integer, user_id::text, create_date::timestamp without time zone, change_date::timestamp without time zone, lesn::integer, resn::integer, lzip::integer, rzip::integer, lcommcode::text, rcommcode::text, route_id::text, now()::date as added_date, ''::text as change_flag, 'TO'::text as source from coagis.bc_street except select  ST_AsText(shape)::text as shapetext, centerline_id::double precision, road_class::integer, street_prefix::text, street_name::text, street_type::text, street_postdirection::text, street_dupe::text, full_street_name::text, speed_limit::integer, lane_count::integer, left_from_address::integer, left_to_address::integer, right_from_address::integer, right_to_address::integer, user_id::text, create_date::timestamp without time zone, change_date::timestamp without time zone, lesn::integer, resn::integer, lzip::integer, rzip::integer, lcommcode::text, rcommcode::text, route_id::text, now()::date as added_date, ''::text as change_flag, 'TO'::text as source from coagis.bc_street_yesterday;
  values:
- name: Logging deleted Changes in coagis.coa_historical_logger_bc_street;
  text: insert into coagis.coa_historical_logger_bc_street select   ST_AsText(shape)::text as shapetext, centerline_id::double precision, road_class::integer, street_prefix::text, street_name::text, street_type::text, street_postdirection::text, street_dupe::text, full_street_name::text, speed_limit::integer, lane_count::integer, left_from_address::integer, left_to_address::integer, right_from_address::integer, right_to_address::integer, user_id::text, create_date::timestamp without time zone, change_date::timestamp without time zone, lesn::integer, resn::integer, lzip::integer, rzip::integer, lcommcode::text, rcommcode::text, route_id::text, now()::date as added_date, ''::text as change_flag, 'FROM'::text as source from coagis.bc_street_yesterday except select  ST_AsText(shape)::text as shapetext, centerline_id::double precision, road_class::integer, street_prefix::text, street_name::text, street_type::text, street_postdirection::text, street_dupe::text, full_street_name::text, speed_limit::integer, lane_count::integer, left_from_address::integer, left_to_address::integer, right_from_address::integer, right_to_address::integer, user_id::text, create_date::timestamp without time zone, change_date::timestamp without time zone, lesn::integer, resn::integer, lzip::integer, rzip::integer, lcommcode::text, rcommcode::text, route_id::text, now()::date as added_date, ''::text as change_flag, 'FROM'::text as source from coagis.bc_street;
  values:
- name: Mark added  Changes in coagis.coa_historical_logger_bc_street;
  text: UPDATE coagis.coa_historical_logger_bc_street as ch  SET  change_flag = 'ADDED'  WHERE  ch.centerline_id = (SELECT c.centerline_id FROM coagis.bc_street  AS c LEFT JOIN coagis.bc_street_yesterday AS y ON c.centerline_id = y.centerline_id WHERE y.centerline_id IS NULL and c.centerline_id = ch.centerline_id)   AND ch.added_date = now()::date;
  values:
- name: Mark Deleted Changes in coagis.coa_historical_logger_bc_street;
  text: UPDATE coagis.coa_historical_logger_bc_street as ch  SET  change_flag = 'DELETED'  WHERE ch.centerline_id = (SELECT y.centerline_id FROM coagis.bc_street as c RIGHT JOIN coagis.bc_street_yesterday AS y ON c.centerline_id = y.centerline_id WHERE c.centerline_id IS NULL and y.centerline_id = ch.centerline_id) AND ch.added_date = now()::date;
  values:
- name: Mark Changed  Changes in coagis.coa_historical_logger_bc_street;
  text: UPDATE coagis.coa_historical_logger_bc_street as ch  SET change_flag = 'CHANGED' WHERE change_flag = '' AND ch.added_date = now()::date;
  values:
